/*!
 * ColorPicker - Colorpicker custom template variable
 * Version: 1.0.3
 * Build date: 2017-03-27
 */

Ext.namespace("Ext.ux"),Ext.ux.ColorPicker=Ext.extend(Ext.BoxComponent,{initComponent:function(){this.applyDefaultsCP(),Ext.ux.ColorPicker.superclass.initComponent.apply(this,arguments),this.addEvents("select")},onRender:function(){Ext.ux.ColorPicker.superclass.onRender.apply(this,arguments),this.body=this.body||this.container||this.renderTo||Ext.DomHelper.append(Ext.getBody(),{},!0),this.el||(this.el=this.body,this.cls&&Ext.get(this.el).addClass(this.cls)),this.renderComponent()},applyDefaultsCP:function(){Ext.apply(this,{cls:"x-cp-mainpanel",resizable:this.resizable||!1,HSV:{h:0,s:0,v:0},updateMode:null})},renderComponent:function(){Ext.DomHelper.append(this.body,{id:this.cpGetId("rgb"),cls:"x-cp-rgbpicker"}),Ext.DomHelper.append(this.body,{id:this.cpGetId("hue"),cls:"x-cp-huepicker"}),this.huePicker=Ext.DomHelper.append(this.body,{cls:"x-cp-hueslider"}),this.hueDD=new Ext.dd.DD(this.huePicker,"huePicker"),this.hueDD.constrainTo(this.cpGetId("hue"),{top:-7,right:-3,bottom:-7,left:-3}),this.hueDD.onDrag=this.moveHuePicker.createDelegate(this),Ext.get(this.cpGetId("hue")).on("mousedown",this.clickHUEPicker.createDelegate(this)),Ext.get(this.huePicker).moveTo(Ext.get(this.cpGetId("hue")).getLeft()-3,Ext.get(this.cpGetId("hue")).getTop()-7),this.rgbPicker=Ext.DomHelper.append(this.body,{cls:"x-cp-rgbslider"}),this.rgbDD=new Ext.dd.DD(this.rgbPicker,"rgbPicker"),this.rgbDD.constrainTo(this.cpGetId("rgb"),-7),this.rgbDD.onDrag=this.moveRGBPicker.createDelegate(this),Ext.get(this.cpGetId("rgb")).on("mousedown",this.clickRGBPicker.createDelegate(this)),Ext.get(this.rgbPicker).moveTo(Ext.get(this.cpGetId("rgb")).getLeft()-7,Ext.get(this.cpGetId("rgb")).getTop()-7),this.formPanel=new Ext.form.FormPanel({renderTo:Ext.DomHelper.append(this.body,{id:this.cpGetId("fCont"),cls:"x-cp-formcontainer"},!0),frame:!0,labelAlign:"left",labelWidth:10,forceLayout:!0,items:[{layout:"column",items:[{columnWidth:.5,layout:"form",defaultType:"numberfield",defaults:{width:42,value:0,minValue:0,maxValue:255,allowBlank:!1,labelSeparator:""},items:[{fieldLabel:"R",id:this.cpGetId("iRed")},{fieldLabel:"G",id:this.cpGetId("iGreen")},{fieldLabel:"B",id:this.cpGetId("iBlue")}]},{columnWidth:.5,layout:"form",defaultType:"numberfield",defaults:{width:42,value:0,minValue:0,maxValue:255,allowBlank:!1,labelSeparator:""},items:[{fieldLabel:"H",maxValue:360,id:this.cpGetId("iHue")},{fieldLabel:"S",id:this.cpGetId("iSat")},{fieldLabel:"V",id:this.cpGetId("iVal")}]}]},{layout:"form",defaultType:"textfield",labelAlign:"left",defaults:{width:127,value:"000000",labelSeparator:"",allowBlank:!1},id:this.cpGetId("cCont"),items:[{fieldLabel:"#",id:this.cpGetId("iHexa"),value:"000000"}]}]}),Ext.getCmp(this.cpGetId("iRed")).on("change",this.updateFromIRGB.createDelegate(this)),Ext.getCmp(this.cpGetId("iGreen")).on("change",this.updateFromIRGB.createDelegate(this)),Ext.getCmp(this.cpGetId("iBlue")).on("change",this.updateFromIRGB.createDelegate(this)),Ext.getCmp(this.cpGetId("iHue")).on("change",this.updateFromIHSV.createDelegate(this)),Ext.getCmp(this.cpGetId("iSat")).on("change",this.updateFromIHSV.createDelegate(this)),Ext.getCmp(this.cpGetId("iVal")).on("change",this.updateFromIHSV.createDelegate(this)),Ext.getCmp(this.cpGetId("iHexa")).on("change",this.updateFromIHexa.createDelegate(this)),Ext.DomHelper.append(this.cpGetId("cCont"),{cls:"x-btn x-btn-small x-cp-colorbox x-cp-websafe",id:this.cpGetId("cWebSafe")},!0).update("Websafe"),Ext.DomHelper.append(this.cpGetId("cCont"),{cls:"x-btn x-btn-small x-cp-colorbox x-cp-inverse",id:this.cpGetId("cInverse")},!0).update("Inverse"),Ext.DomHelper.append(this.cpGetId("cCont"),{cls:"x-btn x-btn-small x-cp-colorbox x-cp-pickcolor",id:this.cpGetId("cColor")},!0).update("Pick Color"),Ext.get(this.cpGetId("cWebSafe")).on("click",this.updateFromBox.createDelegate(this)),Ext.get(this.cpGetId("cInverse")).on("click",this.updateFromBox.createDelegate(this)),Ext.get(this.cpGetId("cColor")).on("click",this.selectColor.createDelegate(this))},cpGetId:function(a){return this.getId()+"__"+(a||"cp")},updateRGBPosition:function(a,b){this.updateMode="click",a=a<0?0:a,a=a>181?181:a,b=b<0?0:b,b=b>181?181:b,this.HSV.s=this.getSaturation(a),this.HSV.v=this.getValue(b),Ext.get(this.rgbPicker).moveTo(Ext.get(this.cpGetId("rgb")).getLeft()+a-7,Ext.get(this.cpGetId("rgb")).getTop()+b-7,this.animateMove||!0),this.updateColor()},updateHUEPosition:function(a){this.updateMode="click",a=a<1?1:a,a=a>181?181:a,this.HSV.h=Math.round(360/181*(181-a)),Ext.get(this.huePicker).moveTo(Ext.get(this.huePicker).getLeft(),Ext.get(this.cpGetId("hue")).getTop()+a-7,this.animateMove||!0),this.updateRGBPicker(this.HSV.h),this.updateColor()},clickRGBPicker:function(a,b){this.updateRGBPosition(a.xy[0]-Ext.get(this.cpGetId("rgb")).getLeft(),a.xy[1]-Ext.get(this.cpGetId("rgb")).getTop())},clickHUEPicker:function(a,b){this.updateHUEPosition(a.xy[1]-Ext.get(this.cpGetId("hue")).getTop())},moveRGBPicker:function(a){this.rgbDD.constrainTo(this.cpGetId("rgb"),-7),this.updateRGBPosition(Ext.get(this.rgbPicker).getLeft()-Ext.get(this.cpGetId("rgb")).getLeft()+7,Ext.get(this.rgbPicker).getTop()-Ext.get(this.cpGetId("rgb")).getTop()+7)},moveHuePicker:function(a){this.hueDD.constrainTo(this.cpGetId("hue"),{top:-7,right:-3,bottom:-7,left:-3}),this.updateHUEPosition(Ext.get(this.huePicker).getTop()-Ext.get(this.cpGetId("hue")).getTop()+7)},updateRGBPicker:function(a){this.updateMode="click",Ext.get(this.cpGetId("rgb")).setStyle({"background-color":"#"+this.rgbToHex(this.hsvToRgb(a,1,1))}),this.updateColor()},updateColor:function(){var a=this.hsvToRgb(this.HSV.h,this.HSV.s,this.HSV.v),b=this.websafe(a),c=this.invert(a),d=this.invert(b);"hexa"!==this.updateMode&&Ext.getCmp(this.cpGetId("iHexa")).setValue(this.rgbToHex(a)),"rgb"!==this.updateMode&&(Ext.getCmp(this.cpGetId("iRed")).setValue(a[0]),Ext.getCmp(this.cpGetId("iGreen")).setValue(a[1]),Ext.getCmp(this.cpGetId("iBlue")).setValue(a[2])),"hsv"!==this.updateMode&&(Ext.getCmp(this.cpGetId("iHue")).setValue(Math.round(this.HSV.h)),Ext.getCmp(this.cpGetId("iSat")).setValue(Math.round(100*this.HSV.s)),Ext.getCmp(this.cpGetId("iVal")).setValue(Math.round(100*this.HSV.v))),Ext.get(this.cpGetId("cColor")).setStyle({background:"#"+this.rgbToHex(a),color:"#"+this.rgbToHex(c)}),Ext.getDom(this.cpGetId("cColor")).title="#"+this.rgbToHex(a),Ext.get(this.cpGetId("cInverse")).setStyle({background:"#"+this.rgbToHex(c),color:"#"+this.rgbToHex(a)}),Ext.getDom(this.cpGetId("cInverse")).title="#"+this.rgbToHex(c),Ext.get(this.cpGetId("cWebSafe")).setStyle({background:"#"+this.rgbToHex(b),color:"#"+this.rgbToHex(d)}),Ext.getDom(this.cpGetId("cWebSafe")).title="#"+this.rgbToHex(b),Ext.get(this.huePicker).moveTo(Ext.get(this.huePicker).getLeft(),Ext.get(this.cpGetId("hue")).getTop()+this.getHPos(Ext.getCmp(this.cpGetId("iHue")).getValue())-7,this.animateMove||!0),Ext.get(this.rgbPicker).moveTo(Ext.get(this.cpGetId("rgb")).getLeft()+this.getSPos(Ext.getCmp(this.cpGetId("iSat")).getValue()/100)-7,Ext.get(this.cpGetId("hue")).getTop()+this.getVPos(Ext.getCmp(this.cpGetId("iVal")).getValue()/100)-7,this.animateMove||!0),Ext.get(this.cpGetId("rgb")).setStyle({"background-color":"#"+this.rgbToHex(this.hsvToRgb(Ext.getCmp(this.cpGetId("iHue")).getValue(),1,1))})},setColor:function(a){/^[0-9a-fA-F]{6}$/.test(a)&&(Ext.getCmp(this.cpGetId("iHexa")).setValue(a),this.updateFromIHexa())},updateFromIRGB:function(a,b,c){this.updateMode="rgb";var d=this.rgbToHsv(Ext.getCmp(this.cpGetId("iRed")).getValue(),Ext.getCmp(this.cpGetId("iGreen")).getValue(),Ext.getCmp(this.cpGetId("iBlue")).getValue());this.HSV={h:d[0],s:d[1],v:d[2]},this.updateColor()},updateFromIHSV:function(a,b,c){this.updateMode="hsv",this.HSV={h:Ext.getCmp(this.cpGetId("iHue")).getValue(),s:Ext.getCmp(this.cpGetId("iSat")).getValue()/100,v:Ext.getCmp(this.cpGetId("iVal")).getValue()/100},this.updateColor()},updateFromIHexa:function(a,b,c){this.updateMode="hexa";var d=this.rgbToHsv(this.hexToRgb(Ext.getCmp(this.cpGetId("iHexa")).getValue()));this.HSV={h:d[0],s:d[1],v:d[2]},this.updateColor()},updateFromBox:function(a,b){this.updateMode="click";var c=this.rgbToHsv(this.hexToRgb(Ext.get(b).getColor("backgroundColor","","")));this.HSV={h:c[0],s:c[1],v:c[2]},this.updateColor()},selectColor:function(a,b){this.fireEvent("select",this,Ext.get(b).getColor("backgroundColor","",""))},hsvToRgb:function(a,b,c){if(a instanceof Array)return this.hsvToRgb.call(this,a[0],a[1],a[2]);var d,e,f,g,h,i,j,k;switch(g=Math.floor(a/60%6),h=a/60-g,i=c*(1-b),j=c*(1-h*b),k=c*(1-(1-h)*b),g){case 0:d=c,e=k,f=i;break;case 1:d=j,e=c,f=i;break;case 2:d=i,e=c,f=k;break;case 3:d=i,e=j,f=c;break;case 4:d=k,e=i,f=c;break;case 5:d=c,e=i,f=j}return[this.realToDec(d),this.realToDec(e),this.realToDec(f)]},rgbToHsv:function(a,b,c){if(a instanceof Array)return this.rgbToHsv.call(this,a[0],a[1],a[2]);a/=255,b/=255,c/=255;var d,e,f,g,h;switch(d=Math.min(Math.min(a,b),c),e=Math.max(Math.max(a,b),c),f=e-d,e){case d:g=0;break;case a:g=60*(b-c)/f,b<c&&(g+=360);break;case b:g=60*(c-a)/f+120;break;case c:g=60*(a-b)/f+240}return h=0===e?0:1-d/e,[Math.round(g),h,e]},realToDec:function(a){return Math.min(255,Math.round(256*a))},rgbToHex:function(a,b,c){return a instanceof Array?this.rgbToHex.call(this,a[0],a[1],a[2]):this.decToHex(a)+this.decToHex(b)+this.decToHex(c)},decToHex:function(a){var b="0123456789ABCDEF";return a=parseInt(a,10),a=isNaN(a)?0:a,a=a>255||a<0?0:a,b.charAt((a-a%16)/16)+b.charAt(a%16)},getHCharPos:function(a){return"0123456789ABCDEF".indexOf(a.toUpperCase())},hexToDec:function(a){var b=a.split("");return 16*this.getHCharPos(b[0])+this.getHCharPos(b[1])},hexToRgb:function(a){return[this.hexToDec(a.substr(0,2)),this.hexToDec(a.substr(2,2)),this.hexToDec(a.substr(4,2))]},getHue:function(a){var b=360-Math.round((181-a)/181*360);return 360===b?0:b},getHPos:function(a){return 181-a*(181/360)},getSaturation:function(a){return a/181},getSPos:function(a){return 181*a},getValue:function(a){return(181-a)/181},getVPos:function(a){return 181-181*a},checkSafeNumber:function(a){if(!isNaN(a)){a=Math.min(Math.max(0,a),255);var b,c;for(b=0;b<256;b+=51)if(c=b+51,a>=b&&a<=c)return a-b>25?c:b}return a},websafe:function(a,b,c){return a instanceof Array?this.websafe.call(this,a[0],a[1],a[2]):[this.checkSafeNumber(a),this.checkSafeNumber(b),this.checkSafeNumber(c)]},invert:function(a,b,c){return a instanceof Array?this.invert.call(this,a[0],a[1],a[2]):[255-a,255-b,255-c]}}),Ext.ux.ColorDialog=Ext.extend(Ext.Window,{initComponent:function(){this.width=!this.width||this.width<353?353:this.width,this.applyDefaultsCP(),Ext.ux.ColorDialog.superclass.initComponent.apply(this,arguments)},onRender:function(){Ext.ux.ColorDialog.superclass.onRender.apply(this,arguments),this.renderComponent()}}),Ext.applyIf(Ext.ux.ColorDialog.prototype,Ext.ux.ColorPicker.prototype),Ext.ux.ColorPanel=Ext.extend(Ext.Panel,{initComponent:function(){this.width=!this.width||this.width<300?300:this.width,this.applyDefaultsCP(),Ext.ux.ColorPanel.superclass.initComponent.apply(this,arguments)},onRender:function(){Ext.ux.ColorPanel.superclass.onRender.apply(this,arguments),this.renderComponent()}}),Ext.applyIf(Ext.ux.ColorPanel.prototype,Ext.ux.ColorPicker.prototype),Ext.reg("colorpicker",Ext.ux.ColorPicker),Ext.reg("colordialog",Ext.ux.ColorDialog),Ext.reg("colorpanel",Ext.ux.ColorPanel),Ext.namespace("Ext.ux","Ext.ux.menu","Ext.ux.form"),"2"===Ext.version.substr(0,1)?(Ext.ux.menu.ColorItem=function(a){a||(a={}),a.style="width:400px;",Ext.ux.menu.ColorItem.superclass.constructor.call(this,new Ext.ux.ColorPicker(a),a),this.picker=this.component,this.addEvents("select"),this.picker.on("render",function(a){a.getEl().swallowEvent("click")}),this.picker.on("select",this.onSelect,this)},Ext.extend(Ext.ux.menu.ColorItem,Ext.menu.Adapter,{onSelect:function(a,b){this.fireEvent("select",this,b,a),Ext.ux.menu.ColorItem.superclass.handleClick.call(this)}}),Ext.ux.menu.ColorMenu=function(a){Ext.ux.menu.ColorMenu.superclass.constructor.call(this,a),this.plain=!0;var b=new Ext.ux.menu.ColorItem(a);this.add(b),this.picker=b.picker,this.relayEvents(b,["select"])},Ext.extend(Ext.ux.menu.ColorMenu,Ext.menu.Menu,{beforeDestroy:function(){this.picker.destroy()}})):Ext.ux.menu.ColorMenu=Ext.extend(Ext.menu.Menu,{enableScrolling:!1,hideOnClick:!0,initComponent:function(){Ext.apply(this,{plain:!0,showSeparator:!1,items:this.picker=new Ext.ux.ColorPicker(Ext.apply({style:"width:400px;"},this.initialConfig))}),this.picker.purgeListeners(),Ext.ux.menu.ColorMenu.superclass.initComponent.call(this),this.relayEvents(this.picker,["select"]),this.on("select",this.menuHide,this),this.handler&&this.on("select",this.handler,this.scope||this)},menuHide:function(){this.hideOnClick&&this.hide(!0)}}),Ext.ux.form.ColorPickerField=Ext.extend(Ext.form.TriggerField,{triggerClass:"x-form-colorpicker-trigger",initComponent:function(){Ext.ux.form.ColorPickerField.superclass.initComponent.call(this),this.menu=new Ext.ux.menu.ColorMenu},setValue:function(a){if(/^[0-9a-fA-F]{6}$/.test(a)){Ext.ux.form.ColorPickerField.superclass.setValue.apply(this,arguments);var b=this.menu.picker.rgbToHex(this.menu.picker.invert(this.menu.picker.hexToRgb(a)));this.el.applyStyles("background: #"+a+"; color: #"+b+";")}},onDestroy:function(){this.menu&&this.menu.destroy(),this.wrap&&this.wrap.remove(),Ext.ux.form.ColorPickerField.superclass.onDestroy.call(this)},onBlur:function(){Ext.ux.form.ColorPickerField.superclass.onBlur.call(this);var a=this.getValue();if(/^[0-9a-fA-F]{6}$/.test(a)){var b=this.menu.picker.rgbToHex(this.menu.picker.invert(this.menu.picker.hexToRgb(a)));this.el.applyStyles("background: #"+a+"; color: #"+b+";")}else this.el.applyStyles("background: #ffffff; color: #000000;")},menuListeners:{select:function(a,b){this.setValue(b),this.fireEvent("select",this,b),this.focus.defer(10,this)},show:function(a){this.onFocus()},hide:function(){this.focus.defer(10,this);var a=this.menuListeners;this.menu.un("select",a.select,this),this.menu.un("show",a.show,this),this.menu.un("hide",a.hide,this)}},onTriggerClick:function(){this.disabled||(this.menu.on(Ext.apply({},this.menuListeners,{scope:this})),this.menu.show(this.el,"tl-bl?"),this.menu.picker.setColor(this.getValue()))}}),Ext.reg("colorpickerfield",Ext.ux.form.ColorPickerField);var colorpicker=function(a){a=a||{},colorpicker.superclass.constructor.call(this,a)};Ext.extend(colorpicker,Ext.Component,{page:{},window:{},grid:{},tree:{},panel:{},combo:{},config:{},jquery:{},form:{}}),Ext.reg("colorpicker",colorpicker),Colorpicker=new colorpicker;